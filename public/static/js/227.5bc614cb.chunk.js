"use strict";(self.webpackChunkto_do_list=self.webpackChunkto_do_list||[]).push([[227],{227:(e,s,a)=>{a.r(s),a.d(s,{default:()=>w});var l=a(555),i=a(43),t=a(216),r=a(204),n=a(837),o=a(820),d=a(962),c=a(805),u=a(603),p=a(579);const v=e=>(0,p.jsx)("div",{className:"avatar-container",children:(0,p.jsx)("img",{className:"avatar-img",src:e.image,alt:e.alt,style:{width:e.width||120,height:e.height||120}})});var h=a(291),m=a(863),x=a(699),j=a(886),f=a(630);const w=()=>{const[e,s]=(0,i.useState)(!1),[a,w]=(0,i.useState)(!1),[N,A]=(0,i.useState)(!1),g=(0,i.useContext)(j.c),y=(0,t.g)().userId,{isLoading:V,error:C,sendRequest:k,errorHandler:T}=(0,h.x)(),[I,b]=(0,i.useState)(null),[E,P,_]=(0,c.m)({name:{value:"",isValid:!1},email:{value:"",isValid:!1},oldPassword:{value:"",isValid:!1},newPassword:{value:"",isValid:!1},image:{value:"",isValid:!0}},!1);let H;(0,i.useEffect)((()=>{y&&g.token?(async()=>{try{const e=await k("http://localhost:5001/api"+"/users/".concat(y,"/profile"),"GET",null,{Authorization:"Bearer "+g.token});if(!e||!e.name||!e.email)throw new Error("Invalid profile data received");_({name:{value:e.name,isValid:!0},email:{value:e.email,isValid:!0},image:{value:e.image||"",isValid:!0},oldPassword:{value:"",isValid:!0},newPassword:{value:"",isValid:!0}},!0),b(e)}catch(e){console.error("Error fetching profile:",e),b(null)}})():console.error("Missing userId or auth token:",{userId:y,hasToken:!!g.token})}),[k,_,y,g.token]);const S=(B=(null===I||void 0===I?void 0:I.totalTasksCount)||0)>=15?{level:"Expert",color:"#00b894"}:B>=10?{level:"Advanced",color:"#0984e3"}:B>=5?{level:"Intermediate",color:"#fdcb6e"}:{level:"Beginner",color:"#e17055"};var B;if(!I&&!V)return(0,p.jsx)("div",{className:"center",children:(0,p.jsxs)(n.A,{children:[(0,p.jsx)("h2",{children:"Could not find profile!"}),(0,p.jsx)("p",{children:"Please check if you are logged in correctly."})]})});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(f.A,{show:e,header:"Profile Updated Successfully!",footer:(0,p.jsx)("div",{className:"update-footer",children:(0,p.jsx)(u.A,{inverse:!0,onClick:()=>s(!1),children:"Close"})})}),(0,p.jsx)(x.A,{error:C,onClear:T}),V&&(0,p.jsx)("div",{className:"center",children:(0,p.jsx)(m.A,{})}),!V&&I&&(0,p.jsxs)("div",{className:"profile-container",children:[(0,p.jsxs)("div",{className:"profile-header",children:[(0,p.jsxs)("h2",{children:["Welcome, ",I.name]}),(0,p.jsxs)("div",{className:"trust-badge",style:{backgroundColor:S.color},children:[(0,p.jsx)(r.e7y,{}),(0,p.jsxs)("span",{children:[S.level," User"]})]})]}),(0,p.jsxs)("div",{className:"profile-content",children:[(0,p.jsxs)("div",{className:"profile-sidebar",children:[(0,p.jsx)("div",{className:"profile-avatar-section",children:(0,p.jsx)(v,{image:I.image?"http://localhost:5001"+"/".concat(I.image):void 0,alt:I.name})}),(0,p.jsxs)("div",{className:"profile-stats",children:[(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsx)(r.w8j,{}),(0,p.jsx)("h3",{children:"Total Tasks"}),(0,p.jsx)("p",{children:I.totalTasksCount||0})]}),(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsx)(r.M5n,{}),(0,p.jsx)("h3",{children:"Created Tasks"}),(0,p.jsx)("p",{children:I.createdTasksCount||0})]}),(0,p.jsxs)("div",{className:"stat-card",children:[(0,p.jsx)(r.YYR,{}),(0,p.jsx)("h3",{children:"Assigned Tasks"}),(0,p.jsx)("p",{children:I.assignedTasksCount||0})]})]})]}),(0,p.jsx)("div",{className:"profile-form-section",children:(0,p.jsxs)(n.A,{className:"profile-form-card",children:[(0,p.jsx)("h3",{children:"Update Profile"}),(0,p.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e={name:E.inputs.name.value,email:E.inputs.email.value,image:E.inputs.image.value};if(E.inputs.oldPassword.value&&E.inputs.newPassword.value&&(e.oldPassword=E.inputs.oldPassword.value,e.newPassword=E.inputs.newPassword.value),H=await k("http://localhost:5001/api"+"/users/".concat(y,"/profile"),"PATCH",JSON.stringify(e),{"Content-Type":"application/json",Authorization:"Bearer "+g.token}),!H||!H.name||!H.email)throw new Error("Invalid update response received");b(H),_((0,l.A)((0,l.A)({},E.inputs),{},{oldPassword:{value:"",isValid:!0},newPassword:{value:"",isValid:!0}}),!0)}catch(s){console.error("Error updating profile:",s)}},children:[(0,p.jsx)(o.A,{id:"name",element:"input",label:"Name",validators:[(0,d.B_)()],onInput:P,initialValue:I.name,initialValid:!0}),(0,p.jsx)(o.A,{id:"email",element:"input",label:"Email",type:"email",validators:[(0,d.i$)()],onInput:P,initialValue:I.email,initialValid:!0}),(0,p.jsxs)("div",{className:"password-input-container",children:[(0,p.jsx)(o.A,{id:"oldPassword",element:"input",label:"Old Password",type:a?"text":"password",validators:[(0,d.Ik)(6)],onInput:P,errorText:"Enter your current password (min 6 characters)"}),(0,p.jsx)("button",{type:"button",className:"password-toggle-profile old-password-toggle",onClick:()=>{w(!a)},children:a?(0,p.jsx)(r.mx3,{}):(0,p.jsx)(r.Ny1,{})})]}),(0,p.jsxs)("div",{className:"password-input-container",children:[(0,p.jsx)(o.A,{id:"newPassword",element:"input",label:"New Password",type:N?"text":"password",validators:[(0,d.Ik)(6)],onInput:P,errorText:"Enter a new password (min 6 characters)"}),(0,p.jsx)("button",{type:"button",className:"password-toggle-profile new-password-toggle",onClick:()=>{A(!N)},children:N?(0,p.jsx)(r.mx3,{}):(0,p.jsx)(r.Ny1,{})})]}),(0,p.jsxs)("div",{className:"profile-actions",children:[(0,p.jsx)(u.A,{type:"submit",onClick:()=>s(!0),disabled:!E.isValid,children:"Update Profile"}),(0,p.jsx)(u.A,{onClick:g.logout,inverse:!0,children:"Logout"})]})]})]})})]})]})]})}},805:(e,s,a)=>{a.d(s,{m:()=>r});var l=a(555),i=a(43);const t=(e,s)=>{switch(s.type){case"INPUT_CHANGE":let a=!0;for(const l in e.inputs)e.inputs[l]&&(a=l===s.inputId?a&&s.isValid:a&&e.inputs[l].isValid);return(0,l.A)((0,l.A)({},e),{},{inputs:(0,l.A)((0,l.A)({},e.inputs),{},{[s.inputId]:{value:s.value,isValid:s.isValid}}),isValid:a});case"SET_DATA":return{inputs:s.inputs,isValid:s.formIsValid};default:return e}},r=(e,s)=>{const[a,l]=(0,i.useReducer)(t,{inputs:e,isValid:s});return[a,(0,i.useCallback)(((e,s,a)=>{l({type:"INPUT_CHANGE",value:s,isValid:a,inputId:e})}),[]),(0,i.useCallback)(((e,s)=>{l({type:"SET_DATA",inputs:e,formIsValid:s})}),[])]}},820:(e,s,a)=>{a.d(s,{A:()=>o});var l=a(555),i=a(43),t=a(962),r=a(579);const n=(e,s)=>{switch(s.type){case"CHANGE":return(0,l.A)((0,l.A)({},e),{},{value:s.val,isValid:(0,t.tf)(s.val,s.isValid)});case"TOUCH":return(0,l.A)((0,l.A)({},e),{},{isTouch:!0});case"RADIO_CHANGE":return(0,l.A)((0,l.A)({},e),{},{value:s.val,isValid:(0,t.tf)(s.val,(0,t.B_)())});default:return e}},o=e=>{const[s,a]=(0,i.useReducer)(n,{value:e.initialValue||"",isTouch:!1,isValid:e.initialValid||!1}),{id:l,onInput:t}=e,{value:o,isValid:d}=s;(0,i.useEffect)((()=>{"function"===typeof t&&t(l,o,d)}),[l,o,d,t]);const c=s=>{a({type:"CHANGE",val:s.target.value,validators:e.validators})},u=()=>{a({type:"TOUCH"})},p=s=>s.map((s=>(0,r.jsxs)("label",{className:s.className,children:[(0,r.jsx)("input",{type:"radio",name:s.id,value:s.value,checked:o===s.value,onChange:()=>{return e=s.value,void a({type:"RADIO_CHANGE",value:e});var e},onBlur:u}),(0,r.jsx)("span",{className:e.span,children:s.label})]},s.value))),v="input"===e.element?(0,r.jsx)("input",{id:e.id,type:e.type,placeholder:e.placeholder,onChange:c,onBlur:u,value:s.value}):"radio"===e.element?(0,r.jsxs)("div",{className:e.className,children:[(0,r.jsx)("label",{className:"radio-inputs__title",children:e.label}),(0,r.jsx)("hr",{}),()=>p(e.radioOptions)]}):(0,r.jsx)("textarea",{id:e.id,rows:e.rows||3,onChange:c,onBlur:u,value:s.value});return(0,r.jsxs)("div",{className:"form-control ".concat(!s.isValid&&s.isTouch&&"form-control--invalid"),children:["radio"!==e.element&&(0,r.jsx)("label",{htmlFor:e.id,children:e.label}),v,!s.isValid&&s.isTouch&&(0,r.jsx)("p",{children:e.errorText})]})}},837:(e,s,a)=>{a.d(s,{A:()=>i});a(43);var l=a(579);const i=e=>(0,l.jsx)("div",{className:"card ".concat(e.className),style:e.style,children:e.children})},962:(e,s,a)=>{a.d(s,{B_:()=>n,Ik:()=>o,i$:()=>d,tf:()=>c});const l="REQUIRE",i="MINLENGTH",t="MAXLENGTH",r="EMAIL",n=()=>({type:l}),o=e=>({type:i,val:e}),d=()=>({type:r}),c=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!0;for(const n of s)n.type===l&&(a=a&&e.trim().length>0),n.type===i&&(a=a&&e.trim().length>=n.val),n.type===t&&(a=a&&e.trim().length<=n.val),"MIN"===n.type&&(a=a&&+e>=n.val),"MAX"===n.type&&(a=a&&+e<=n.val),n.type===r&&(a=a&&/^\S+@\S+\.\S+$/.test(e));return a}}}]);
//# sourceMappingURL=227.5bc614cb.chunk.js.map